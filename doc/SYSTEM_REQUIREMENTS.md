# GrammarZen 系统需求说明书

**版本**: 1.7.1
**日期**: 2024-05-27
**项目名称**: GrammarZen (中文智能校对)

---

## 1. 引言

### 1.1 项目背景
GrammarZen 是一款基于大语言模型（LLM）的现代化中文智能校对工具。旨在解决日常写作、公文处理及内容创作中常见的错别字、语病、排版及合规问题。通过集成 Google Gemini、DeepSeek 及讯飞星火等多家顶尖模型，提供高精度、低延迟的校对服务。

### 1.2 适用范围
本系统适用于个人写作者、企业文案人员、公文处理人员以及需要进行内容合规审查的媒体从业者。

---

## 2. 功能性需求

### 2.1 核心校对功能
系统需提供多种针对不同场景的校对模式：
1.  **快速模式 (Fast)**: 侧重于明显的错别字、标点错误，响应速度快。
2.  **专业深度 (Professional)**: 进行深度语法分析、音似形似字纠错及润色建议。
3.  **合规专项 (Sensitive)**: **忽略**语法错误，仅检测敏感词、广告法违禁词（如“第一”、“顶级”）及政治敏感内容。
4.  **公文规范 (Official)**: 检查党政机关公文格式、领导人排序及严肃用语规范。
5.  **智能润色 (Polishing)**: 提供学术、商务、创意、口语等多种风格的润色改写。
6.  **格式分析 (Format)**: 专注于检查排版、字体、字号及标点挤压问题。
7.  **原文件检测 (File Scan)**: 直接分析 PDF/图片文件的视觉内容，进行整体质量评估。

### 2.2 多模态输入
系统需支持以下格式的输入与解析：
1.  **纯文本**: 支持直接粘贴编辑。
2.  **Word (.docx)**: 自动提取文档文本。
3.  **PDF (.pdf)**: 支持文本提取及扫描件的图像渲染分析。
4.  **图片 (.jpg/.png/.webp)**: 支持 OCR 文字识别及视觉排版分析。
5.  **文本文件 (.txt/.rtf)**: 支持纯文本及富文本格式解析。

### 2.3 结果展示与交互
1.  **双视图**: 提供“阅读模式”（Clean）和“修订模式”（Diff View，红删绿增）。
2.  **问题卡片**: 结构化展示错误类型（错别字/语病/合规/格式等）、原句、建议及原因。
3.  **交互操作**: 支持采纳、忽略、加入白名单。支持一键批量采纳或忽略。
4.  **全屏模式**: 提供沉浸式阅读体验。
5.  **原文件预览**: 上传文件后可预览原始文件（PDF/图片页）。

### 2.4 用户系统与数据同步
1.  **身份认证**: 支持邮箱注册与登录（基于 Supabase Auth）。
2.  **个人中心**:
    *   修改用户昵称。
    *   修改登录密码。
    *   **头像管理**: 支持上传本地图片作为头像（大小限制 2MB）。
3.  **云端同步**:
    *   **白名单**: 用户定义的忽略词汇自动同步至云端。
    *   **敏感词库**: 用户上传或添加的敏感词自动同步。
    *   **规则库**: 用户创建的自定义校验规则自动同步。

### 2.5 高级配置
1.  **多模型支持**: 支持切换 Google Gemini (Flash/Pro), DeepSeek (V3/R1), 讯飞星火 (Ultra/Max) 等模型。
2.  **自定义规则库**: 支持通过自然语言（如粘贴企业手册）自动提取并生成校验规则。
3.  **词库管理**: 支持导入 .txt/.csv 格式的敏感词库，或加载系统内置词库。

### 2.6 导出功能
支持导出校对结果为：
1.  纯文本 (.txt)
2.  Word 文档 (.doc)
3.  Markdown 完整报告 (.md)

---

## 3. 非功能性需求

### 3.1 性能要求
*   **首屏加载**: 在标准 4G 网络下首屏加载时间 < 2秒。
*   **解析速度**: 10MB 以内的文档解析时间 < 3秒。
*   **校对响应**: 流式输出（Streaming），用户点击开始后 1秒内应看到首字生成。

### 3.2 安全性要求
*   **数据隐私**: 用户上传的文档仅在浏览器端解析，直接传输至 LLM API，不经过第三方应用服务器存储（Supabase 仅存储配置数据和头像）。
*   **API Key 保护**: 建议在生产环境通过后端代理转发 API 请求（当前版本为前端直连，依赖环境变量）。
*   **存储安全**: 用户头像存储于 Supabase Storage，启用 RLS (行级安全策略) 确保用户只能管理自己的文件。

### 3.3 兼容性要求
*   支持主流现代浏览器：Chrome (90+), Edge, Firefox, Safari。
*   响应式设计，适配桌面端、平板及移动端界面。

---

## 4. 运行环境
*   **前端运行时**: 浏览器环境 (ESModule 支持)。
*   **后端服务**: Supabase (PostgreSQL + GoTrue + Storage)。
*   **AI 服务**: Google AI Studio / DeepSeek API / iFlytek Spark API。
