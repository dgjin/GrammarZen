# GrammarZen 系统功能说明书

**版本**: 1.6.0  
**更新日期**: 2024-05-26

---

## 1. 产品概述
GrammarZen 是一款基于先进大语言模型（LLM）的中文智能校对与润色工具。它不仅能纠正基础的错别字和语病，还能进行内容合规性审查、公文规范检查及文风润色。系统支持多模态输入（文本、文档、图片），并提供直观的修订对比界面，帮助用户高效提升文本质量。

---

## 2. 核心功能模块

### 2.1 智能校对模式 (Check Modes)
系统内置多种针对不同场景的校对引擎，用户可点击工具栏按钮灵活切换：

| 模式名称 | 图标 | 适用场景 | 功能特点 |
| :--- | :--- | :--- | :--- |
| **快速模式** (Fast) | ⚡ | 日常写作、即时通讯 | 速度最快，专注于明显的错别字、标点错误和基础语病。 |
| **专业深度** (Professional) | ✨ | 论文、出版物、重要文章 | 深度分析语法逻辑、形似音似字错误，提供专业的润色建议。 |
| **合规专项** (Sensitive) | 🛡️ | 广告文案、媒体发布 | **忽略**语法错误，仅专注于敏感词、广告法违禁词（如“最高级”）、政治敏感及隐私信息检测。 |
| **公文规范** (Official) | 🏅 | 党政机关公文、正式函件 | 检查政治用语规范、领导人排序、公文格式标准及严肃用语风格。 |
| **智能润色** (Polishing) | ✒️ | 文案优化、演讲稿 | 不改变原意的前提下，优化句式结构，提升文采，使表达更优雅流畅。 |
| **格式分析** (Format) | 🖼️ | 排版检查、PDF/图片文档 | 专注于字体、字号、页边距、段落间距等排版规范性检查（建议配合 PDF/图片上传使用）。 |
| **原文件** (Original File) | 📂 | 扫描件、整体文档分析 | 直接将文件（PDF/图片）传给模型进行多模态分析，保留视觉上下文，适合整体质量评估。 |

### 2.2 多模态输入支持
系统支持多种格式的文档直接导入，无需手动复制粘贴：

1.  **纯文本输入**：支持直接在输入框编辑或粘贴文本。
2.  **Word 文档 (.docx)**：前端自动解析文档内容提取文本。
3.  **PDF 文档 (.pdf)**：
    *   **文本模式**：自动提取可编辑文本。
    *   **视觉模式**：对于扫描件，支持按页渲染为高清晰度图像进行视觉识别。
4.  **图片 (.jpg, .png, .webp)**：支持 OCR 识别及排版分析。
5.  **纯文本 (.txt)**：自动识别 UTF-8 编码并导入。
6.  **富文本 (.rtf)**：内置解析器，自动去除 RTF 格式代码提取纯文本。

> **注意**：单文件大小限制为 10MB。

### 2.3 结果交互与展示
校对完成后，系统提供交互式的报告界面：

*   **修订模式 (Diff View)**：采用类似 Word 修订模式的视图，**红色删除线**表示建议删除的内容，**绿色下划线**表示建议新增的内容。支持点击高亮区域定位对应的问题卡片。
*   **阅读模式 (Clean View)**：直接查看采纳所有建议后的最终文本效果。
*   **问题卡片 (Issue Cards)**：
    *   **分类展示**：问题按类型（错别字、语病、合规、格式等）分类。
    *   **操作工具栏**：支持“采纳”、“忽略”及“忽略并加入白名单”。
    *   **批量操作**：支持一键“全部采纳”或“全部忽略”。
*   **质量评分**：AI 根据文本质量给出的 0-100 分综合评分及一句话总结。

### 2.4 导出功能
支持将校对结果导出为本地文件：
*   **仅校对文本 (.txt)**：导出修正后的纯文本。
*   **Word 文档 (.doc)**：导出带有基本段落格式的文档。
*   **完整报告 (.md)**：生成包含评分、总结、全文及详细问题列表的 Markdown 报告。

---

## 3. 高级配置与个性化

### 3.1 多模型引擎切换
用户可根据需求选择底层 AI 模型：
*   **Google Gemini** (默认)：
    *   `Gemini 3.0 Flash`: 速度极快，适合长文本。
    *   `Gemini 3.0 Pro`: 逻辑推理能力更强，适合复杂公文。
*   **DeepSeek** (需配置 Key)：
    *   `DeepSeek V3 (Chat)`: 通用对话能力强。
    *   `DeepSeek R1 (Reasoner)`: 擅长深度推理和逻辑检查。
*   **科大讯飞星火** (需配置 Key)：
    *   支持 `Ultra 4.0`, `Max`, `Pro` 等多个版本，中文理解能力优异。

### 3.2 自定义规则库 (Rule Library)
针对企业或特定项目的写作规范，用户可建立本地规则库：
*   **智能提取**：用户只需粘贴文档规范（如《品牌写作手册》），AI 自动提取出可执行的校验规则。
*   **动态应用**：在校对时勾选特定的规则库，系统会强制执行库中的规则（如“统一将 APP 写作 App”）。

### 3.3 敏感词管理
*   **本地词库**：用户可手动添加特定敏感词。
*   **文件导入**：支持导入 `.txt`, `.csv` 格式的敏感词列表。
*   **内置词库**：系统预置了“广告法违禁词库”和“通用违禁词库”，可一键加载。
*   **检测逻辑**：系统会对所有标记为敏感词的内容发出最高级别的红色警告。

### 3.4 白名单系统 (Whitelist)
*   对于专有名词、人名或特定术语，用户可将其加入白名单。
*   加入白名单的词汇在后续校对中将被 AI **绝对忽略**，不再报错。

---

## 4. 隐私与安全
*   **前端处理**：Word (.docx) 解析、RTF 解析及 PDF 渲染均在浏览器端（Client-side）完成，原始文件不会被上传至无关服务器（直接发送至所选的 AI 模型 API）。
*   **PII 检测**：系统内置隐私信息检测指令，会自动识别并提示身份证号、手机号、银行卡号等敏感信息，建议脱敏处理。

---

## 5. 常见问题 (FAQ)

*   **Q: 上传 Word 文档提示格式错误？**
    *   A: 请确保文档未被加密，且为标准的 `.docx` (Office 2007+) 格式。旧版 `.doc` 格式暂不支持。
*   **Q: 如何配置 DeepSeek 或星火模型？**
    *   A: 需要在项目根目录的 `.env` 文件中配置相应的 `DEEPSEEK_API_KEY` 或 `SPARK_API_KEY`，并重启服务。
*   **Q: 为什么“原文件”模式没有显示具体的修订对比？**
    *   A: “原文件”模式下，AI 分析的是文件的整体视觉或二进制内容，可能无法精确对应到字符级的差异，因此更适合查看整体报告和宏观建议。