# 更新日志 (Changelog)

本项目的所有显著更改都将记录在此文件中。

## [1.6.0] - 2024-05-26
### 新增
- **更多文件格式支持**：
  - 新增 **.txt (纯文本)** 和 **.rtf (富文本)** 格式的上传与校对支持。
  - 内置轻量级 RTF 解析引擎，无需后端转换即可在前端提取内容。
- **原文件检测模式 (File Scan)**：
  - 新增“原文件”校对模式按钮。
  - 针对 PDF 和图片格式，该模式直接将文件二进制流（Visual Context）传给 AI 模型，保留文档的视觉排版上下文，适合进行全局性的格式、排版及逻辑检查。

### 修复
- **Word 文档兼容性修复**：
  - 修复了上传 `.docx` 文件时提示 "Unsupported MIME type" 的错误。
  - 优化了 Word 文档的处理逻辑，确保始终通过前端引擎 (`mammoth`) 提取文本后再进行 AI 分析，绕过了模型对 `.docx` 二进制数据直接输入的限制。

## [1.5.0] - 2024-05-25
### 新增
- **新增模型支持**：
  - **DeepSeek**：新增 DeepSeek V3 (Chat) 和 DeepSeek R1 (Reasoner) 模型选项。
  - **科大讯飞星火**：新增星火 Spark Ultra 4.0 模型选项。
  - 需要在 `.env` 文件中分别配置 `DEEPSEEK_API_KEY` 和 `SPARK_API_KEY`。
- **服务层重构**：
  - 服务层现支持 OpenAI 兼容接口，实现了通用的流式 JSON 解析逻辑，确保新模型也能返回结构化的校对结果。

## [1.4.1] - 2024-05-24
### 修复
- **依赖修复**：
  - 将 `@google/genai` 版本更新为 `latest`，解决本地部署时 `npm install` 出现的 `ETARGET` 错误。

## [1.4.0] - 2024-05-24
### 新增
- **多模型切换支持**：
  - 在输入框工具栏新增模型选择器。
  - 支持 **Gemini 3.0 Flash** (默认，极速) 和 **Gemini 3.0 Pro** (推理增强) 两种模型。
  - 用户可根据文本复杂度和对逻辑推理的要求灵活选择合适的模型。

## [1.3.0] - 2024-05-23
### 新增
- **合规专项检查模式 (Sensitive Check Mode)**：
  - 新增独立的检查模式，AI 仅专注于敏感词、广告法违规和内容安全检查。
  - 该模式下会自动忽略错别字和润色建议，确保合规审核的高效性。
- **系统内置词库加载**：
  - 在敏感词管理中增加“系统内置词库”板块。
  - 支持从项目根目录 `Vocabulary` 文件夹加载预设词库（如“广告法违禁词库”、“通用违禁词库”）。
- **Vocabulary 文件夹**：
  - 新增 `public/Vocabulary` 目录，预置了基础的合规检测词表。

## [1.2.1] - 2024-05-22
### 新增
- **敏感词库文件导入**：
  - 在敏感词管理弹窗中增加“文件导入”功能。
  - 支持 `.txt` (每行一个或分隔符)、`.csv`、`.json` (字符串数组) 格式。
  - 实现自动去重逻辑，避免重复添加已有词汇。

## [1.2.0] - 2024-05-22
### 新增
- **本地敏感词库管理**：
  - 新增敏感词管理界面，支持手动添加、删除敏感词。
  - 数据持久化存储于 LocalStorage (`grammarzen_sensitive_words`)。
  - 顶部导航栏增加“敏感词库”入口及实时计数显示。
- **合规性校验引擎升级**：
  - 更新 Gemini System Instruction，强制模型对用户定义的敏感词进行 `sensitive` 类型标记。
  - 增加对广告法违禁词（如“第一”、“顶级”）、政治敏感及低俗内容的专项检测指令。

### 优化
- **UI 交互**：
  - 敏感词类型的错误卡片现在使用醒目的玫瑰红色（Rose-600）样式，与普通拼写错误（红色/橙色）及建议（紫色）在视觉上明确区分。
  - 优化了 Prompt 结构，确保白名单和敏感词库指令的优先级最高。

## [1.1.0] - 2024-05-21
### 新增
- **本地规则库 (Rule Library)**：
  - 支持用户输入文档规范（如《企业写作指南》），利用 AI 自动提取可执行的校验规则。
  - 规则库支持多选应用，校验时动态注入 Prompt，实现定制化校对。
- **白名单系统 (Whitelist)**：
  - 支持将特定词汇加入白名单，校验时模型将绝对忽略这些词汇。
  - 结果卡片增加“忽略并加入白名单”快捷操作，提升用户体验。

### 优化
- **PDF 解析升级**：
  - 引入 `pdfjs-dist` 实现纯前端 PDF 文本提取，替代了原有的纯视觉识别或后端依赖，提升了解析速度和隐私安全性。
  - 增加对扫描版 PDF 的回退机制（自动切换为图片模式）。

## [1.0.0] - 2024-05-20
### 初始发布
- **核心功能**：
  - 基于 Google Gemini (`gemini-3-flash-preview`) 的中文智能校对。
  - 提供 **快速模式** (侧重纠错) 与 **专业深度模式** (侧重润色与合规)。
  - 支持 **多模态输入**：纯文本、图片 (OCR)、PDF、Word (.docx)。
- **结果展示**：
  - 双视图支持：**阅读模式** (Clean) 与 **修订模式** (Diff View，红删绿增)。
  - 结构化问题卡片，支持单个采纳、忽略、批量操作。
  - 智能质量评分 (0-100) 与 AI 总结。
- **导出功能**：
  - 支持导出校对后的纯文本 (.txt)。
  - 支持导出详细的 Markdown 校对报告 (.md)。